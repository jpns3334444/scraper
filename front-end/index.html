<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>東京不動産 | Tokyo Real Estate</title>
    
    <!-- Japanese-inspired Favicon with red seal -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'><rect width='32' height='32' fill='%23faf8f5'/><circle cx='16' cy='16' r='12' fill='none' stroke='%23c73929' stroke-width='2'/><text x='16' y='20' text-anchor='middle' fill='%23c73929' font-family='serif' font-size='12'>東</text></svg>">
    
    <!-- Preload Japanese Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@200;400;900&display=swap" rel="stylesheet">
    
    <!-- Styles with Sumi-e aesthetic -->
    <link rel="stylesheet" href="shared/styles/base.css">
    <link rel="stylesheet" href="shared/styles/layout.css">
    <link rel="stylesheet" href="shared/styles/components.css">
    <link rel="stylesheet" href="features/properties/properties.css">
    <link rel="stylesheet" href="features/favorites/favorites.css">
    <link rel="stylesheet" href="features/auth/auth.css">
    <link rel="stylesheet" href="features/hidden/hidden.css">
</head>
<body>
    <!-- SVG Filters for Ink Effects -->
    <svg style="position: absolute; width: 0; height: 0;">
        <defs>
            <filter id="turbulence">
                <feTurbulence type="fractalNoise" baseFrequency="0.02" numOctaves="3" result="turb" />
                <feDisplacementMap in="SourceGraphic" in2="turb" scale="3" />
            </filter>
            <filter id="roughPaper">
                <feTurbulence type="fractalNoise" baseFrequency="0.04" numOctaves="5" result="noise" />
                <feDiffuseLighting in="noise" lighting-color="white" surfaceScale="1">
                    <feDistantLight azimuth="45" elevation="60" />
                </feDiffuseLighting>
            </filter>
        </defs>
    </svg>

    <!-- Enso Circle Background Decoration -->
    <div class="enso-decoration">
        <svg viewBox="0 0 600 600">
            <circle cx="300" cy="300" r="290" />
        </svg>
    </div>

    <!-- Floating Ink Particles -->
    <div class="ink-particle" style="left: 10%; animation-delay: 0s;"></div>
    <div class="ink-particle" style="left: 30%; animation-delay: 3s;"></div>
    <div class="ink-particle" style="left: 50%; animation-delay: 6s;"></div>
    <div class="ink-particle" style="left: 70%; animation-delay: 9s;"></div>
    <div class="ink-particle" style="left: 90%; animation-delay: 12s;"></div>

    <!-- Authentication Modal -->
    <div id="authModal" class="modal"></div>
    
    <!-- User Info Display -->
    <div id="userInfo" class="user-info" style="display: none;">
        <span id="userEmail"></span>
        <button onclick="logout()">ログアウト</button>
    </div>
    
    <!-- Sign In Button for Anonymous Users -->
    <div id="signInPrompt" class="user-info" style="display: none;">
        <button onclick="showAuthModal()">サインイン</button>
    </div>
    
    <!-- Error Banner -->
    <div id="errorBanner" class="error-banner" style="display: none;">
        <span id="errorMessage"></span>
        <button onclick="hideErrorBanner()">✕</button>
    </div>
    
    <div class="container">
        <h1>東京不動産</h1>
        <p style="text-align: center; color: var(--ink-light); margin-top: -3rem; margin-bottom: 3rem; letter-spacing: 0.3em; font-size: 14px;">TOKYO REAL ESTATE</p>
        
        <!-- Tab Navigation with Brush Stroke Effect -->
        <div class="tab-navigation" id="tabNavigation"></div>
        
        <!-- Properties Tab -->
        <div id="properties-tab" class="tab-pane active">
            <div class="loading" id="loading">
                <!-- Loading skeleton will be populated by PropertiesView -->
            </div>
            
            <div class="table-container" id="tableContainer" style="display: none;">
                <table>
                    <thead>
                        <!-- Table header will be populated by PropertiesView -->
                    </thead>
                    <tbody id="propertiesTable">
                        <!-- Table rows will be populated by PropertiesView -->
                    </tbody>
                </table>
            </div>
            
            <!-- Section Divider -->
            <div class="section-divider"></div>
            
            <!-- Pagination -->
            <div class="pagination-container" id="paginationContainer" style="display: none;">
                <div class="pagination" id="pagination"></div>
            </div>
        </div>
        
        <!-- Favorites Tab -->
        <div id="favorites-tab" class="tab-pane" style="display: none;">
            <div class="favorites-container" id="favoritesList"></div>
        </div>
        
        <!-- Hidden Tab -->
        <div id="hidden-tab" class="tab-pane" style="display: none;">
            <ul class="fav-list" id="hiddenList"></ul>
        </div>
    </div>
    
    <!-- Load JavaScript modules in correct order -->
    <script src="config/constants.js"></script>
    <script src="shared/utils/formatters.js"></script>
    <script src="shared/utils/storage.js"></script>
    <script src="shared/utils/dom.js"></script>
    <script src="core/api.js"></script>
    <script src="core/state.js"></script>
    <script src="core/router.js"></script>
    <script src="shared/components/Pagination.js"></script>
    <script src="shared/components/FilterDropdown.js"></script>
    <script src="shared/components/Table.js"></script>
    <script src="features/auth/AuthManager.js"></script>
    <script src="features/auth/AuthModal.js"></script>
    <script src="features/properties/PropertiesManager.js"></script>
    <script src="features/properties/PropertiesView.js"></script>
    <script src="features/favorites/FavoritesManager.js"></script>
    <script src="features/favorites/FavoritesView.js"></script>
    <script src="features/hidden/HiddenManager.js"></script>
    <script src="features/hidden/HiddenView.js"></script>
    <script src="main.js"></script>

    <!-- Additional Sumi-e Interactions -->
    <script>
        // Dynamic ink wash effect on mouse movement for cards
        document.addEventListener('DOMContentLoaded', function() {
            // Create more floating particles periodically
            setInterval(function() {
                const particle = document.createElement('div');
                particle.className = 'ink-particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = '0s';
                particle.style.animationDuration = (10 + Math.random() * 10) + 's';
                document.body.appendChild(particle);
                
                setTimeout(() => particle.remove(), 20000);
            }, 5000);

            // Add mouse tracking for ink wash effects on property cards
            document.addEventListener('mousemove', function(e) {
                const cards = document.querySelectorAll('.property-card, .favorite-card');
                cards.forEach(card => {
                    const rect = card.getBoundingClientRect();
                    if (e.clientX >= rect.left && e.clientX <= rect.right &&
                        e.clientY >= rect.top && e.clientY <= rect.bottom) {
                        const x = ((e.clientX - rect.left) / rect.width) * 100;
                        const y = ((e.clientY - rect.top) / rect.height) * 100;
                        card.style.setProperty('--x', `${x}%`);
                        card.style.setProperty('--y', `${y}%`);
                    }
                });
            });
        });
    </script>
</body>
</html>